import{u as Y,c as L,r as t,A as T,j as e,g as F,d as N,b as y,a as p,B as I,k as A}from"./index-DfFaXGpw.js";import{u as B,T as M}from"./Toast-CyKevOvG.js";const R=()=>{const g=Y(),f=L(),{toasts:C,removeToast:k,success:w,error:d}=B(),[E,P]=t.useState(!0),[x,j]=t.useState(!1),[o,c]=t.useState(!1),[i,m]=t.useState({name:"",email:"",phone:"",linkedin:"",github:"",portfolio:"",bio:"",college:"",degree:"",graduationYear:"",skills:"",role:"user"}),[u,b]=t.useState(0),v=s=>{if(!s)return 0;const a={name:s.name,email:s.email,phone:s.phone,college:s.college,degree:s.degree,graduationYear:s.graduationYear,bio:s.bio,linkedin:s.linkedin,github:s.github,portfolio:s.portfolio,skills:s.skills},n=Object.values(a).filter(h=>h?typeof h=="string"?h.trim().length>0:!0:!1).length,l=Object.keys(a).length;return Math.round(n/l*100)};t.useEffect(()=>{f.state?.showIncompleteProfileWarning&&(d("Please complete your profile (Name, Email, Education) to access other pages."),c(!0),window.history.replaceState({},document.title));const s=T(p,async a=>{if(!a){g("/login");return}try{const n=await F(N(y,"users",a.uid));if(n.exists()){const l=n.data();m({name:l.name||"",email:l.email||a.email||"",phone:l.phone||"",linkedin:l.linkedin||"",github:l.github||"",portfolio:l.portfolio||"",bio:l.bio||"",college:l.college||"",degree:l.degree||"",graduationYear:l.graduationYear||"",skills:l.skills||"",role:l.role||"user"}),b(v(l))}else m(l=>({...l,email:a.email}))}catch(n){console.error("Error loading profile:",n),d("Failed to load profile")}finally{P(!1)}});return()=>s()},[f.state]);const r=s=>{const{name:a,value:n}=s.target;m(l=>({...l,[a]:n}))},S=async s=>{s.preventDefault(),j(!0);try{const a=p.currentUser;if(!a)throw new Error("Not authenticated");await A(N(y,"users",a.uid),{...i,email:a.email},{merge:!0}),w("Profile updated successfully!"),c(!1),b(v(i))}catch(a){console.error("Error saving profile:",a),d("Failed to save profile")}finally{j(!1)}},D=async()=>{window.confirm("Are you sure you want to logout?")&&(await I(p),g("/login"))};return E?e.jsx("div",{className:"profile-page",children:e.jsx("div",{className:"loading-container",children:e.jsx("p",{children:"Loading profile..."})})}):e.jsxs("div",{className:"profile-page",children:[C.map(s=>e.jsx(M,{message:s.message,type:s.type,onClose:()=>k(s.id)},s.id)),e.jsxs("div",{className:"container profile-container",children:[e.jsxs("div",{className:"profile-header",children:[e.jsxs("div",{className:"header-text",children:[e.jsx("h1",{children:"My Profile"}),e.jsx("p",{className:"text-secondary",children:"Manage your personal information and portfolio"})]}),e.jsxs("div",{className:"profile-actions",children:[o?e.jsx("button",{className:"btn btn-secondary",onClick:()=>c(!1),children:"Cancel"}):e.jsx("button",{className:"btn btn-primary",onClick:()=>c(!0),children:"Edit Profile"}),e.jsx("button",{className:"btn btn-danger",onClick:D,children:"Logout"})]})]}),e.jsxs("div",{className:"completion-card card",children:[e.jsxs("div",{className:"completion-header",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Profile Completion"}),e.jsx("p",{children:"Complete your profile to get better recommendations"})]}),e.jsx("div",{className:"completion-percentage",children:e.jsxs("span",{className:u===100?"complete":"incomplete",children:[u,"%"]})})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${u}%`}})})]}),e.jsxs("form",{onSubmit:S,className:"profile-form",children:[e.jsxs("div",{className:"form-section card",children:[e.jsx("h2",{children:"Personal Information"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Full Name"}),e.jsx("input",{type:"text",name:"name",value:i.name,onChange:r,disabled:!o,placeholder:"John Doe"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",name:"email",value:i.email,disabled:!0,className:"input-disabled"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",value:i.phone,onChange:r,disabled:!o,placeholder:"+91 9876543210"})]})]})]}),e.jsxs("div",{className:"form-section card",children:[e.jsx("h2",{children:"Education"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"College/University"}),e.jsx("input",{type:"text",name:"college",value:i.college,onChange:r,disabled:!o,placeholder:"IIT Delhi"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Degree"}),e.jsx("input",{type:"text",name:"degree",value:i.degree,onChange:r,disabled:!o,placeholder:"B.Tech in Computer Science"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Graduation Year"}),e.jsx("input",{type:"text",name:"graduationYear",value:i.graduationYear,onChange:r,disabled:!o,placeholder:"2024"})]})]})]}),e.jsxs("div",{className:"form-section card",children:[e.jsx("h2",{children:"Professional Links"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"LinkedIn"}),e.jsx("input",{type:"url",name:"linkedin",value:i.linkedin,onChange:r,disabled:!o,placeholder:"https://linkedin.com/in/yourprofile"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"GitHub"}),e.jsx("input",{type:"url",name:"github",value:i.github,onChange:r,disabled:!o,placeholder:"https://github.com/yourusername"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Portfolio"}),e.jsx("input",{type:"url",name:"portfolio",value:i.portfolio,onChange:r,disabled:!o,placeholder:"https://yourportfolio.com"})]})]})]}),e.jsxs("div",{className:"form-section card",children:[e.jsx("h2",{children:"About"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Bio"}),e.jsx("textarea",{name:"bio",value:i.bio,onChange:r,disabled:!o,rows:"4",placeholder:"Tell us about yourself..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Skills (comma-separated)"}),e.jsx("textarea",{name:"skills",value:i.skills,onChange:r,disabled:!o,rows:"2",placeholder:"React, Node.js, Python, MongoDB"})]})]}),o&&e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:x,children:x?"Saving...":"Save Changes"})})]})]})]})};export{R as default};

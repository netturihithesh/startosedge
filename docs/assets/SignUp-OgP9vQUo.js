import{u as y,r as m,j as e,L as v,l as N,a as t,k as p,d as g,b as h,m as P,h as C,i as S,n as A}from"./index-7n7QxWWA.js";import{u as k,T as E}from"./Toast-BEM2NpJh.js";const U=()=>{const c=y(),{toasts:f,success:u,error:o,removeToast:w}=k(),[r,x]=m.useState({fullName:"",email:"",password:"",confirmPassword:""}),[d,n]=m.useState(!1),l=s=>{x({...r,[s.target.name]:s.target.value})},j=async s=>{if(s.preventDefault(),r.password!==r.confirmPassword){o("Passwords don't match!");return}n(!0);try{const a=await N(t,r.email,r.password);try{await p(g(h,"users",a.user.uid),{name:r.fullName,email:r.email,role:"user",createdAt:new Date})}catch(i){throw console.error("Firestore creation failed:",i),await a.user.delete(),new Error("Failed to create user profile. Please try again.")}await P(a.user),await t.signOut(),u("Account created! Verification email sent. Please check your inbox and verify before logging in."),setTimeout(()=>{c("/login")},4e3)}catch(a){console.error("Signup error:",a);let i="Signup failed. Please try again.";a.code==="auth/email-already-in-use"&&(i="Email already in use."),a.code==="auth/weak-password"&&(i="Password is too weak (minimum 6 characters)."),a.message.includes("Failed to create user profile")&&(i=a.message),o(i)}finally{n(!1)}},b=async()=>{n(!0);try{const s=await C(t,S),a=s.user;if(!A(s)?.isNewUser){await t.signOut(),o("Account already exists with this email. Please log in."),setTimeout(()=>{window.location.href="#/login",window.location.reload()},2e3);return}await p(g(h,"users",a.uid),{name:a.displayName,email:a.email,role:"user",createdAt:new Date},{merge:!0}),u("Account created successfully!"),setTimeout(()=>{c("/profile")},1500)}catch(s){console.error("Google signup error:",s);let a="Google signup failed.";s.code==="auth/popup-closed-by-user"?a="Signup cancelled by user.":s.code==="auth/popup-blocked"?a="Signup popup blocked by browser. Please allow popups.":s.code==="auth/operation-not-allowed"?a="Google signup is not enabled. Contact admin.":s.code==="auth/unauthorized-domain"?a="This domain is not authorized for signup. Contact admin.":s.message&&(a=`Signup failed: ${s.message}`),o(a),n(!1)}};return e.jsxs("div",{className:"signup-page",children:[d&&e.jsxs("div",{className:"full-screen-loader",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Processing..."})]}),f.map(s=>e.jsx(E,{message:s.message,type:s.type,onClose:()=>w(s.id)},s.id)),e.jsxs("div",{className:"signup-container",children:[e.jsxs("div",{className:"signup-left",children:[e.jsxs("div",{className:"signup-header",children:[e.jsx("h1",{children:"Create Account"}),e.jsx("p",{children:"Join StartosEdge and kickstart your career."})]}),e.jsxs("form",{className:"signup-form",onSubmit:j,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"fullName",children:"Full Name"}),e.jsx("input",{type:"text",id:"fullName",name:"fullName",placeholder:"John Doe",value:r.fullName,onChange:l,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",name:"email",placeholder:"john@example.com",value:r.email,onChange:l,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",id:"password",name:"password",placeholder:"Create a password",value:r.password,onChange:l,required:!0,minLength:"6"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",placeholder:"Confirm your password",value:r.confirmPassword,onChange:l,required:!0})]}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-full",disabled:d,children:d?"Creating Account...":"Sign Up"}),e.jsx("div",{className:"divider",children:e.jsx("span",{children:"OR"})}),e.jsxs("button",{type:"button",className:"btn btn-google btn-full",onClick:b,children:[e.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google"}),"Sign up with Google"]})]}),e.jsx("div",{className:"signup-footer",children:e.jsxs("p",{children:["Already have an account? ",e.jsx(v,{to:"/login",children:"Log In"})]})})]}),e.jsx("div",{className:"signup-right",children:e.jsxs("div",{className:"signup-benefits",children:[e.jsx("h3",{children:"Join the Community"}),e.jsx("p",{children:"Get access to exclusive resources, mentorship, and job opportunities."})]})})]})]})};export{U as default};

import{r as i,o as g,j as e}from"./index-Bb-Gqyhp.js";import{s as c}from"./supabaseClient-C98BprbU.js";import{u as N,T as v}from"./Toast-ix2jLu6K.js";const C=()=>{const[o,u]=i.useState([]),[p,x]=i.useState(!0),{isAdmin:n}=g(),{toasts:f,success:d,error:m,removeToast:j}=N(),[r,h]=i.useState({title:"",description:"",coins:"",difficulty:"Medium",skills_required:"",deadline:""});i.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:s,error:a}=await c.from("tasks").select("*").order("created_at",{ascending:!1});if(a)throw a;u(s||[])}catch(s){console.error("Error fetching tasks:",s)}finally{x(!1)}},t=s=>{h({...r,[s.target.name]:s.target.value})},k=async s=>{s.preventDefault();try{const{error:a}=await c.from("tasks").insert([{...r}]);if(a)throw a;d("Task posted successfully!"),h({title:"",description:"",coins:"",difficulty:"Medium",skills_required:"",deadline:""}),l()}catch(a){console.error("Error posting task:",a),m("Failed to post task")}},b=async s=>{if(window.confirm("Delete this task?"))try{const{error:a}=await c.from("tasks").delete().eq("id",s);if(a)throw a;d("Task deleted"),l()}catch(a){console.error("Error deleting task:",a),m("Failed to delete task")}};return e.jsxs("div",{className:"taskhub-container section",children:[f.map(s=>e.jsx(v,{message:s.message,type:s.type,onClose:()=>j(s.id)},s.id)),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"taskhub-header",children:[e.jsx("h1",{className:"text-gradient",children:"TaskHub"}),e.jsx("p",{className:"section-description",children:"Complete tasks, earn rewards, and build your portfolio."})]}),n&&e.jsxs("div",{className:"admin-panel card fade-in-up",children:[e.jsx("h3",{children:"Post a New Task"}),e.jsxs("form",{onSubmit:k,className:"task-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Job Title"}),e.jsx("input",{type:"text",name:"title",value:r.title,onChange:t,required:!0,placeholder:"e.g. React Frontend Developer"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{name:"description",value:r.description,onChange:t,required:!0,placeholder:"Brief description of the task..."})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Required Skills"}),e.jsx("input",{type:"text",name:"skills_required",value:r.skills_required,onChange:t,required:!0,placeholder:"e.g. React, Node.js, CSS"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Coins/Reward"}),e.jsx("input",{type:"number",name:"coins",value:r.coins,onChange:t,required:!0,placeholder:"e.g. 500"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Difficulty"}),e.jsxs("select",{name:"difficulty",value:r.difficulty,onChange:t,children:[e.jsx("option",{children:"Easy"}),e.jsx("option",{children:"Medium"}),e.jsx("option",{children:"Hard"})]})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Post Task"})]})]}),e.jsx("div",{className:"tasks-grid",children:p?e.jsx("p",{className:"text-center",children:"Loading tasks..."}):o.length===0?e.jsxs("div",{className:"no-tasks text-center",children:[e.jsx("p",{children:"No tasks available at the moment."}),n&&e.jsx("p",{children:"Use the form above to post the first task!"})]}):o.map(s=>e.jsxs("div",{className:"task-card card",children:[e.jsxs("div",{className:"task-header",children:[e.jsx("h3",{className:"task-title",children:s.title}),e.jsxs("span",{className:"task-earnings",children:["ðŸª™ ",s.coins]})]}),e.jsx("p",{className:"task-desc",children:s.description}),e.jsxs("div",{className:"task-meta",children:[e.jsx("strong",{children:"Skills:"})," ",s.skills_required,e.jsx("span",{className:`badge ${s.difficulty.toLowerCase()}`,children:s.difficulty})]}),e.jsxs("div",{className:"task-actions",children:[e.jsx("button",{className:"btn btn-primary btn-sm",children:"Apply Now"}),n&&e.jsx("button",{className:"btn btn-secondary btn-sm delete-btn",onClick:()=>b(s.id),children:"Delete"})]})]},s.id))})]})]})};export{C as default};
